<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${book.id == null} ? '도서 등록' : '도서 수정'">도서 등록</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>

<div th:replace="fragments/header :: header"></div>

<div class="container mt-5" style="max-width: 600px;">
    <h2 class="mb-4 text-center" th:text="${book.id == null} ? '도서 등록' : '도서 수정'">도서 등록</h2>

    <form th:action="@{${book.id == null} ? '/books/add' : '/books/edit/' + ${book.id}}"
          th:object="${book}" method="post" enctype="multipart/form-data">

        <div class="mb-3">
            <label class="form-label">제목</label>
            <input type="text" th:field="*{title}" class="form-control"/>
            <div class="text-danger" th:if="${#fields.hasErrors('title')}" th:errors="*{title}"></div>
        </div>

        <div class="mb-3">
            <label class="form-label">저자</label>
            <input type="text" th:field="*{author}" class="form-control"/>
            <div class="text-danger" th:if="${#fields.hasErrors('author')}" th:errors="*{author}"></div>
        </div>

        <div class="mb-3">
            <label class="form-label">출판사</label>
            <input type="text" th:field="*{publisher}" class="form-control"/>
            <div class="text-danger" th:if="${#fields.hasErrors('publisher')}" th:errors="*{publisher}"></div>
        </div>

        <div class="mb-3">
            <label class="form-label">ISBN</label>
            <input type="text" th:field="*{isbn}" class="form-control"/>
            <div class="text-danger" th:if="${#fields.hasErrors('isbn')}" th:errors="*{isbn}"></div>
        </div>

        <div class="mb-3">
            <label class="form-label">재고 수량</label>
            <input type="number" th:field="*{stock}" th:min="${book.id != null ? book.stock : 0}" class="form-control"/>
            <div class="text-danger" th:if="${#fields.hasErrors('stock')}" th:errors="*{stock}"></div>
        </div>

        <div class="mb-3">
            <label class="form-label">도서 이미지</label>
            <input type="file" name="imageFile" accept="image/*" class="form-control"/>
        </div>

        <div th:if="${book.id != null and book.imageFilename != null}" class="mb-3 text-center">
            <p class="mb-2">현재 이미지:</p>
            <img th:src="@{'/upload/thumb/' + ${book.thumbnailFilename}}" alt="썸네일"
                 class="img-thumbnail" style="max-width: 150px;">
        </div>

        <div class="d-grid mb-3">
            <button type="submit" class="btn btn-success" th:text="${book.id == null} ? '등록' : '수정'">등록</button>
        </div>
    </form>

    <div class="d-grid">
        <button type="button" class="btn btn-secondary"
                th:if="${book.id != null}"
                th:onclick="|location.href='/books/${book.id}'|">취소</button>

        <button type="button" class="btn btn-secondary"
                th:if="${book.id == null}"
                onclick="location.href='/books'">취소</button>
    </div>
</div>

<div th:replace="fragments/footer :: footer" class="mt-5"></div>

</body>
</html>



